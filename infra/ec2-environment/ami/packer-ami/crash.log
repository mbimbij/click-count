2021/06/10 12:28:49 [INFO] Packer version: 1.6.6 [go1.15.6 linux amd64]
2021/06/10 12:28:49 Checking 'PACKER_CONFIG' for a config file path
2021/06/10 12:28:49 'PACKER_CONFIG' not set; checking the default config file path
2021/06/10 12:28:49 Attempting to open config file: /home/joseph/.packerconfig
2021/06/10 12:28:49 [WARN] Config file doesn't exist: /home/joseph/.packerconfig
2021/06/10 12:28:49 Setting cache directory: /home/joseph/workspace/click-count/infra/ec2-environment/ami/packer-ami/packer_cache
2021/06/10 12:28:49 Creating plugin client for path: /usr/local/bin/packer
2021/06/10 12:28:49 Starting plugin: /usr/local/bin/packer []string{"/usr/local/bin/packer", "plugin", "packer-builder-amazon-ebs"}
2021/06/10 12:28:49 Waiting for RPC address for: /usr/local/bin/packer
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: [INFO] Packer version: 1.6.6 [go1.15.6 linux amd64]
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: Checking 'PACKER_CONFIG' for a config file path
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: 'PACKER_CONFIG' not set; checking the default config file path
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: Attempting to open config file: /home/joseph/.packerconfig
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: [WARN] Config file doesn't exist: /home/joseph/.packerconfig
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: Setting cache directory: /home/joseph/workspace/click-count/infra/ec2-environment/ami/packer-ami/packer_cache
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: args: []string{"packer-builder-amazon-ebs"}
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: Plugin address: unix /tmp/packer-plugin734187851
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: Waiting for connection...
2021/06/10 12:28:49 Received unix RPC address for /usr/local/bin/packer: addr is /tmp/packer-plugin734187851
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: Serving a plugin connection...
2021/06/10 12:28:49 Creating plugin client for path: /usr/local/bin/packer
2021/06/10 12:28:49 Starting plugin: /usr/local/bin/packer []string{"/usr/local/bin/packer", "plugin", "packer-provisioner-shell"}
2021/06/10 12:28:49 Waiting for RPC address for: /usr/local/bin/packer
2021/06/10 12:28:49 packer-provisioner-shell plugin: [INFO] Packer version: 1.6.6 [go1.15.6 linux amd64]
2021/06/10 12:28:49 packer-provisioner-shell plugin: Checking 'PACKER_CONFIG' for a config file path
2021/06/10 12:28:49 packer-provisioner-shell plugin: 'PACKER_CONFIG' not set; checking the default config file path
2021/06/10 12:28:49 packer-provisioner-shell plugin: Attempting to open config file: /home/joseph/.packerconfig
2021/06/10 12:28:49 packer-provisioner-shell plugin: [WARN] Config file doesn't exist: /home/joseph/.packerconfig
2021/06/10 12:28:49 packer-provisioner-shell plugin: Setting cache directory: /home/joseph/workspace/click-count/infra/ec2-environment/ami/packer-ami/packer_cache
2021/06/10 12:28:49 packer-provisioner-shell plugin: args: []string{"packer-provisioner-shell"}
2021/06/10 12:28:49 packer-provisioner-shell plugin: Plugin address: unix /tmp/packer-plugin492613087
2021/06/10 12:28:49 packer-provisioner-shell plugin: Waiting for connection...
2021/06/10 12:28:49 Received unix RPC address for /usr/local/bin/packer: addr is /tmp/packer-plugin492613087
2021/06/10 12:28:49 packer-provisioner-shell plugin: Serving a plugin connection...
2021/06/10 12:28:49 Preparing build: amazon-ebs
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: [INFO] (aws): No AWS timeout and polling overrides have been set. Packer will default to waiter-specific delays and timeouts. If you would like to customize the length of time between retries and max number of retries you may do so by setting the environment variables AWS_POLL_DELAY_SECONDS and AWS_MAX_ATTEMPTS or the configuration options aws_polling_delay_seconds and aws_polling_max_attempts to your desired values.
2021/06/10 12:28:49 ui: [1;32mamazon-ebs: output will be in this color.[0m
2021/06/10 12:28:49 ui: 
2021/06/10 12:28:49 Build debug mode: false
2021/06/10 12:28:49 Force build: false
2021/06/10 12:28:49 On error: 
2021/06/10 12:28:49 Waiting on builds to complete...
2021/06/10 12:28:49 Starting build run: amazon-ebs
2021/06/10 12:28:49 Running builder: amazon-ebs
2021/06/10 12:28:49 [INFO] (telemetry) Starting builder amazon-ebs
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: [INFO] AWS Auth provider used: "SharedCredentialsProvider"
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: Found region eu-west-1
2021/06/10 12:28:49 packer-builder-amazon-ebs plugin: [INFO] AWS Auth provider used: "SharedCredentialsProvider"
2021/06/10 12:28:49 ui: [1;32m==> amazon-ebs: Prevalidating any provided VPC information[0m
2021/06/10 12:28:49 ui: [1;32m==> amazon-ebs: Prevalidating AMI Name: click-count[0m
2021/06/10 12:28:50 packer-builder-amazon-ebs plugin: Using AMI Filters {
2021/06/10 12:28:50 packer-builder-amazon-ebs plugin:   ImageIds: ["ami-06c5b2809791cf59c"]
2021/06/10 12:28:50 packer-builder-amazon-ebs plugin: }
2021/06/10 12:28:50 ui: [0;32m    amazon-ebs: Found Image ID: ami-06c5b2809791cf59c[0m
2021/06/10 12:28:50 ui: [1;32m==> amazon-ebs: Creating temporary keypair: packer_60c1e961-d6fe-1fe2-4492-cc84cf6d292c[0m
2021/06/10 12:28:50 ui: [1;32m==> amazon-ebs: Creating temporary security group for this instance: packer_60c1e962-0087-2a1a-942d-01715928047a[0m
2021/06/10 12:28:51 packer-builder-amazon-ebs plugin: [DEBUG] Waiting for temporary security group: sg-06385910518993928
2021/06/10 12:28:51 packer-builder-amazon-ebs plugin: [DEBUG] Found security group sg-06385910518993928
2021/06/10 12:28:51 ui: [1;32m==> amazon-ebs: Authorizing access to port 22 from [0.0.0.0/0] in the temporary security groups...[0m
2021/06/10 12:28:51 ui: [1;32m==> amazon-ebs: Launching a source AWS instance...[0m
2021/06/10 12:28:51 ui: [1;32m==> amazon-ebs: Adding tags to source instance[0m
2021/06/10 12:28:51 ui: [0;32m    amazon-ebs: Adding tag: "Name": "Packer Builder"[0m
2021/06/10 12:28:52 ui: [0;32m    amazon-ebs: Instance ID: i-007418cc736818b91[0m
2021/06/10 12:28:52 ui: [1;32m==> amazon-ebs: Waiting for instance (i-007418cc736818b91) to become ready...[0m
2021/06/10 12:29:15 ui error: Cancelling build after receiving interrupt
2021/06/10 12:29:15 packer-provisioner-shell plugin: Received interrupt signal (count: 1). Ignoring.
2021/06/10 12:29:15 Cancelling builder after context cancellation context canceled
2021/06/10 12:29:15 packer-builder-amazon-ebs plugin: Received interrupt signal (count: 1). Ignoring.
2021/06/10 12:29:15 ui error: [1;31m==> amazon-ebs: Error waiting for instance (i-007418cc736818b91) to become ready: RequestCanceled: waiter context canceled
==> amazon-ebs: caused by: context canceled[0m
2021/06/10 12:29:16 ui: [1;32m==> amazon-ebs: No volumes to clean up, skipping[0m
2021/06/10 12:29:16 ui: [1;32m==> amazon-ebs: Deleting temporary security group...[0m
2021/06/10 12:29:16 packer-builder-amazon-ebs plugin: Error deleting security group: DependencyViolation: resource sg-06385910518993928 has a dependent object
2021/06/10 12:29:16 packer-builder-amazon-ebs plugin: 	status code: 400, request id: 83587c34-0275-4391-aa6d-fada47982f7b
2021/06/10 12:29:17 packer-provisioner-shell plugin: Received interrupt signal (count: 2). Ignoring.
2021/06/10 12:29:17 packer-builder-amazon-ebs plugin: Received interrupt signal (count: 2). Ignoring.
2021/06/10 12:29:21 packer-builder-amazon-ebs plugin: Error deleting security group: DependencyViolation: resource sg-06385910518993928 has a dependent object
2021/06/10 12:29:21 packer-builder-amazon-ebs plugin: 	status code: 400, request id: 601a75ed-691a-4226-ae4e-0eeb2b0abf10
2021/06/10 12:29:27 packer-builder-amazon-ebs plugin: Error deleting security group: DependencyViolation: resource sg-06385910518993928 has a dependent object
2021/06/10 12:29:27 packer-builder-amazon-ebs plugin: 	status code: 400, request id: ba5e8fac-c7e9-4d81-86c7-c9ee7448c331
2021/06/10 12:29:32 packer-builder-amazon-ebs plugin: Error deleting security group: DependencyViolation: resource sg-06385910518993928 has a dependent object
2021/06/10 12:29:32 packer-builder-amazon-ebs plugin: 	status code: 400, request id: 6ee312a6-5b1a-43bd-a3a0-8637f5214ec8
2021/06/10 12:29:37 packer-builder-amazon-ebs plugin: Error deleting security group: DependencyViolation: resource sg-06385910518993928 has a dependent object
2021/06/10 12:29:37 packer-builder-amazon-ebs plugin: 	status code: 400, request id: 1b835149-e8b3-4cf6-afb6-ca7014b60b18
2021/06/10 12:29:42 ui error: [1;31m==> amazon-ebs: Error cleaning up security group. Please delete the group manually: err: DependencyViolation: resource sg-06385910518993928 has a dependent object
==> amazon-ebs: 	status code: 400, request id: 1b835149-e8b3-4cf6-afb6-ca7014b60b18; security group ID: sg-06385910518993928[0m
2021/06/10 12:29:42 ui: [1;32m==> amazon-ebs: Deleting temporary keypair...[0m
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: panic: runtime error: invalid memory address or nil pointer dereference
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: [signal SIGSEGV: segmentation violation code=0x1 addr=0x8 pc=0x1a719e1]
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: goroutine 42 [running]:
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: github.com/hashicorp/packer/builder/amazon/common.(*StepRunSourceInstance).Run(0xc0008e22c0, 0x53d07c0, 0xc00042d780, 0x53d1400, 0xc000613c20, 0x0)
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 	/home/circleci/project/packer/builder/amazon/common/step_run_source_instance.go:254 +0x16a1
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: github.com/hashicorp/packer/packer-plugin-sdk/multistep.(*BasicRunner).Run(0xc000613d10, 0x53d07c0, 0xc00042d780, 0x53d1400, 0xc000613c20)
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 	/home/circleci/project/packer/packer-plugin-sdk/multistep/basic_runner.go:70 +0x234
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: github.com/hashicorp/packer/builder/amazon/ebs.(*Builder).Run(0xc000387600, 0x53d07c0, 0xc00042d780, 0x53ebac0, 0xc000612e70, 0x535b8e0, 0xc00034f100, 0x0, 0xc0001845d8, 0xc00064fbd0, ...)
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 	/home/circleci/project/packer/builder/amazon/ebs/builder.go:354 +0x194b
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: github.com/hashicorp/packer/packer-plugin-sdk/rpc.(*BuilderServer).Run(0xc00035d880, 0x1, 0xc00077c0b0, 0x0, 0x0)
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 	/home/circleci/project/packer/packer-plugin-sdk/rpc/builder.go:117 +0x1c4
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: reflect.Value.call(0xc0001845a0, 0xc000182100, 0x13, 0x4d6ecf8, 0x4, 0xc00064ff08, 0x3, 0x3, 0x4ea7bf0, 0xc00008a800, ...)
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 	/usr/local/go/src/reflect/value.go:476 +0x8c7
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: reflect.Value.Call(0xc0001845a0, 0xc000182100, 0x13, 0xc000470f08, 0x3, 0x3, 0xc0005dfab8, 0xc0000c1610, 0x4609c0)
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 	/usr/local/go/src/reflect/value.go:337 +0xb9
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: net/rpc.(*service).call(0xc00035ddc0, 0xc0000ca0a0, 0xc0007c8318, 0xc0007c8320, 0xc000416300, 0xc00000c140, 0x3edd4e0, 0xc00077c0ac, 0x18a, 0x3ddf6a0, ...)
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 	/usr/local/go/src/net/rpc/server.go:377 +0x189
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: created by net/rpc.(*Server).ServeCodec
2021/06/10 12:29:43 packer-builder-amazon-ebs plugin: 	/usr/local/go/src/net/rpc/server.go:474 +0x445
2021/06/10 12:29:43 /usr/local/bin/packer: plugin process exited
2021/06/10 12:29:43 [INFO] (telemetry) ending amazon-ebs
2021/06/10 12:29:43 ui error: [1;31mBuild 'amazon-ebs' errored after 53 seconds 807 milliseconds: unexpected EOF[0m
2021/06/10 12:29:43 ui: 
==> Wait completed after 53 seconds 807 milliseconds
2021/06/10 12:29:43 ui: Cleanly cancelled builds after being interrupted.
2021/06/10 12:29:43 [INFO] (telemetry) Finalizing.
2021/06/10 12:29:43 waiting for all plugin processes to complete...
2021/06/10 12:29:43 /usr/local/bin/packer: plugin process exited
